<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Admin - Tổng Doanh Thu</title>
    <meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no'
          name='viewport'/>
    <link rel="icon" href="/slider_1-main/image/ok.png" type="image/png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="/assets/js/plugin/webfont/webfont.min.js"></script>
 <script src="../assets/js/aside.js"></script>
    <script>
        WebFont.load({
            google: {
                "families": ["Public Sans:300,400,500,600,700"]
            },
            custom: {
                "families": ["Font Awesome 5 Solid", "Font Awesome 5 Regular",
                    "Font Awesome 5 Brands", "simple-line-icons"],
                urls: ['/assets/css/fonts.min.css']
            },
            active: function () {
                sessionStorage.fonts = true;
            }
        });
    </script>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
            rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/plugins.min.css">
    <link rel="stylesheet" href="/assets/css/kaiadmin.min.css">
    <link rel="stylesheet" href="/assets/css/demo.css">
    <!-- Giữ nguyên nếu bạn cần -->
    <link rel="stylesheet"
          href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

</head>
<body>
<style>
    /* Tổng quan */
    body {
        font-family: 'Public Sans', sans-serif;
        background-color: #f8f9fa;
        margin: 0;
        padding: 0;
    }

    /* Header và tiêu đề */
    h4, h6 {
        font-weight: bold;
        color: #333;
        text-align: center;
        margin-bottom: 15px;
    }


    h4.text-center {
        margin-top: 30px;
    }

    /* Info Boxes */
    .info-box {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-align: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .info-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .info-box h6 {
        font-size: 18px;
        font-weight: bold;
        color: #555;
        margin-bottom: 10px;
    }

    .info-box p {
        font-size: 22px;
        font-weight: bold;
        color: #007bff;
    }

    .info-box small {
        color: #666;
        font-size: 14px;
    }

    .info-box i {
        font-size: 24px;
        color: #007bff;
        margin-bottom: 10px;
    }

    /* Bảng */
    table {
        width: 100%;
        background-color: #fff;
        border-collapse: collapse;
        margin-top: 20px;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    thead {
        background-color: #007bff;
        color: #fff;
        font-weight: bold;
    }

    thead th {
        padding: 15px;
        text-align: center;
        font-size: 16px;
    }

    tbody tr {
        border-bottom: 1px solid #ddd;
        transition: background-color 0.2s ease;
    }

    tbody tr:last-child {
        border-bottom: none;
    }

    tbody tr:hover {
        background-color: #f1f1f1;
    }

    tbody td {
        padding: 15px;
        text-align: center;
        font-size: 14px;
        color: #555;
    }

    tbody td:last-child {
        font-weight: bold;
        color: #007bff;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .info-box {
            padding: 15px;
        }

        table thead {
            display: none;
        }

        table tbody tr {
            display: block;
            margin-bottom: 15px;
        }

        table tbody td {
            display: block;
            text-align: left;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        table tbody td:before {
            content: attr(data-label);
            font-weight: bold;
            color: #333;
            display: block;
            margin-bottom: 5px;
        }
    }

    /* Transitions */
    button, .info-box {
        transition: all 0.3s ease;
    }

    button:hover {
        background-color: #0056b3;
    }

    /* Nút bấm */
    button {
        font-size: 14px;
        font-weight: bold;
        padding: 10px 20px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    button.btn-primary {
        background-color: #007bff;
        color: #fff;
    }

    button.btn-primary:hover {
        background-color: #0056b3;
    }

</style>
<div class="wrapper">
    <div th:replace="~{adminViews/aside:: .sidebar}"></div>
        <div class="main-panel">
            <div class="container m-0">
                <div class="page-inner m-0">
                <div class="row mt-4" style="margin-top: 100px">
                    <!-- Tổng Số Vé Bán Ra -->
                    <div class="col-md-4">
                        <div class="info-box">
                            <h6>
                                <i class="bi bi-ticket-perforated-fill"></i> Tổng Số Vé Bán Ra
                            </h6>
                            <p>
                                <span th:text="${totalTickets}"></span> vé
                            </p>
                            <small>Ngày: <span
                                    th:text="${#temporals.format(currentDate, 'dd/MM/yyyy')}"></span></small>
                        </div>
                    </div>

                    <!-- Tổng Doanh Thu Hôm Nay -->
                    <div class="col-md-4">
                        <div class="info-box">
                            <h6>
                                <i class="fas fa-coins"></i> Tổng Doanh Thu Hôm Nay
                            </h6>
                            <p>
                                <span th:text="${totalRevenueFormatted}"></span>
                            </p>
                            <small>Ngày: <span
                                    th:text="${#temporals.format(currentDate, 'dd/MM/yyyy')}"></span></small>
                        </div>
                    </div>

                    <!-- Tổng Doanh Thu Tháng -->
                    <div class="col-md-4">
                        <div class="info-box">
                            <h6>
                                <i class="fas fa-calendar-alt"></i> Tổng Doanh Thu Tháng
                            </h6>
                            <p>
                                <span th:text="${monthlyRevenueFormatted}"></span>
                            </p>
                            <small>Tháng: <span
                                    th:text="${#temporals.format(currentDate, 'MM/yyyy')}"></span></small>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 ps-3 pe-3">
                        <h4 class="text-center">Tất Cả Phim Bán Ra Hôm Nay</h4>
                        <table class="table table-striped custom-table">
                            <thead>
                            <tr>
                                <th>STT</th>
                                <th>Tên Phim</th>
                                <th>Số Vé Bán</th>
                                <th>Doanh Thu</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="movie, iterStat : ${todayMovies}">
                                <td th:text="${iterStat.index + 1}"></td>
                                <td th:text="${movie.movieName}"></td>
                                <td th:text="${movie.ticketCount}"></td>
                                <td th:data-price="${movie.totalRevenue}"></td>
                                <script>
                                    // Chỉ chọn các thẻ <td> có thuộc tính data-price
                                    document.querySelectorAll('td[data-price]').forEach(td => {
                                        const rawPrice = td.getAttribute('data-price'); // Lấy giá trị từ thuộc tính data-price
                                        console.log("Raw price:", rawPrice); // Log giá trị gốc

                                        const price = parseFloat(rawPrice); // Chuyển giá trị sang số
                                        if (!isNaN(price)) { // Nếu là số hợp lệ
                                            // Định dạng tiền Việt Nam và thêm ' VND'
                                            const formattedPrice = new Intl.NumberFormat('vi-VN').format(price) + ' VNĐ';
                                            console.log("Formatted price:", formattedPrice); // Log giá trị sau định dạng
                                            td.textContent = formattedPrice; // Hiển thị giá trị định dạng
                                        } else {
                                            console.log("Invalid price:", rawPrice); // Log nếu giá trị không hợp lệ
                                            td.textContent = "N/A"; // Hiển thị mặc định nếu giá trị không hợp lệ
                                        }
                                    });
                                </script>


                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
         </div>
    </div>
</div>
<script src="/assets/js/core/jquery-3.7.1.min.js"></script>
<script src="/assets/js/core/popper.min.js"></script>
<script src="/assets/js/core/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Bootstrap Notify -->
<script
        src="/assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>
<!-- jQuery Scrollbar -->
<script
        src="/assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
<!-- Kaiadmin JS -->
<script src="/assets/js/kaiadmin.min.js"></script>
<!-- Kaiadmin DEMO methods, don't include it in your project! -->
<script src="/assets/js/setting-demo2.js"></script>

<script type="text/javascript">

</script>

<script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#myTable').DataTable();
    });
</script>

<script>
    $('#displayNotif')
        .on(
            'click',
            function () {
                var placementFrom = $(
                    '#notify_placement_from option:selected')
                    .val();
                var placementAlign = $(
                    '#notify_placement_align option:selected')
                    .val();
                var state = $('#notify_state option:selected')
                    .val();
                var style = $('#notify_style option:selected')
                    .val();
                var content = {};

                content.message = 'Turning standard Bootstrap alerts into "notify" like notifications';
                content.title = 'Bootstrap notify';
                if (style == "withicon") {
                    content.icon = 'fa fa-bell';
                } else {
                    content.icon = 'none';
                }
                content.url = 'movieChart.html.';
                content.target = '_blank';

                $.notify(content, {
                    type: state,
                    placement: {
                        from: placementFrom,
                        align: placementAlign
                    },
                    time: 1000,
                    delay: 0,
                });
            });
</script>
</body>
</html>